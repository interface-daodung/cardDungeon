<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Game Inventory</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="equipments-page">

  <!-- Icon Xu + ƒëi·ªÉm -->
  <div class="score-bar fade-in">
    <span>ü™ô</span>
    <span id="score">0</span>
  </div>

  <!-- Icon setting -->
  <div class="settings-btn-wrapper fade-in">
    <span class="settings-btn">‚öôÔ∏è</span>
  </div>


  <div class="container">
    <!-- L∆∞·ªõi 15 √¥ -->
    <div class="grid">
      <!-- V√≠ d·ª• 15 √¥ item gi·ªëng nhau -->
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/hp.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/infuseDendro.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/damage.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/teleportation.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/key.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/WeaponUp.webp" alt="Item" class="darken" />
      </div>

      <div class="item">
        <div class="item-bg"></div>
        <img src="item/foodUp.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/repair.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/Cooldown.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/blackHole.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/Bow.webp" alt="Item" class="darken" />
      </div>

      <div class="item">
        <div class="item-bg"></div>
        <img src="item/Catalyst.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/Sword.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/resPyro.webp" alt="Item" class="darken" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="item/resCryo.webp" alt="Item" class="darken" />
      </div>
    </div>

    <!-- 3 √¥ trang b·ªã l·ªõn -->
    <div class="equipments">
      <div class="item">
        <div class="item-bg"></div>
        <img src="" alt="Equipment 1" style="display: none;" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="" alt="Equipment 2" style="display: none;" />
      </div>
      <div class="item">
        <div class="item-bg"></div>
        <img src="" alt="Equipment 3" style="display: none;" />
      </div>
    </div>

    <!-- N√∫t quay l·∫°i -->
    <!-- <a href="menu game.html" class="back-btn">Quay l·∫°i</a> -->
  </div>
  <a href="index.html" class="back-btn">Quay l·∫°i</a>

<!-- Dialog cha -->
<div class="item-dialog-wrapper" id="itemDialogWrapper" style="display:none;">
  <!-- Dialog ch√≠nh -->
  <div class="item-dialog">
    <h2 id="dialogItemName">T√™n Item</h2>
    <div class="dialog-content">
      <img id="dialogItemIcon" src="" alt="icon" class="dialog-icon">
      <p id="dialogItemDesc">M√¥ t·∫£ item...</p>
    </div>
  </div>

  <!-- Thanh n√∫t ƒëi·ªÅu khi·ªÉn -->
  <div class="dialog-actions">
    <button id="btnUpgrade">N√¢ng c·∫•p</button>
    <button id="btnSelect">L·ª±a ch·ªçn</button>
  </div>
</div>

    <script>
  // L·∫•y danh s√°ch item trong l∆∞·ªõi v√† trang b·ªã
  const gridItems = document.querySelectorAll('.grid .item');
  const equipmentSlots = document.querySelectorAll('.equipments .item');

  // M·∫£ng l∆∞u v·ªã tr√≠ ƒëang ƒë∆∞·ª£c trang b·ªã (index item grid)
  let equippedIndices = [];

  // H√†m ki·ªÉm tra s·ªë item ƒëang trang b·ªã
  function equippedCount() {
    return equippedIndices.length;
  }

  // X·ª≠ l√Ω click item trong l∆∞·ªõi
  gridItems.forEach((item, idx) => {
    item.addEventListener('click', () => {
      if (equippedCount() >= 3) return; // ƒê·ªß 3 r·ªìi, kh√¥ng th√™m n·ªØa
      if (equippedIndices.includes(idx)) return; // Item n√†y ƒë√£ trang b·ªã r·ªìi

      // T√¨m √¥ trang b·ªã tr·ªëng (kh√¥ng c√≥ ·∫£nh)
      let emptySlot = null;
      for (const slot of equipmentSlots) {
        const img = slot.querySelector('img');
        if (img.style.display === 'none' || img.src === '') {
          emptySlot = slot;
          break;
        }
      }
      if (!emptySlot) return; // Kh√¥ng c√≤n slot tr·ªëng

      // L·∫•y ·∫£nh v√† s·ªë l∆∞·ª£ng t·ª´ item grid
      const imgGrid = item.querySelector('img');
      const countGrid = item.querySelector('.item-count');

      // Hi·ªÉn th·ªã ·∫£nh item v√†o slot tr·ªëng, show ·∫£nh v√† s·ªë l∆∞·ª£ng
      const imgEquip = emptySlot.querySelector('img');
      const countEquip = emptySlot.querySelector('.item-count');

      imgEquip.src = imgGrid.src;
      imgEquip.style.display = 'block';

      if (countEquip) {
        countEquip.textContent = countGrid ? countGrid.textContent : '';
        countEquip.style.display = 'block';
      }

      // ·∫®n ·∫£nh trong item grid ƒë·ªÉ ƒë√°nh d·∫•u ƒë√£ ch·ªçn
      imgGrid.style.display = 'none';
      if (countGrid) countGrid.style.display = 'none';

      // L∆∞u index item ƒë√£ trang b·ªã
      equippedIndices.push(idx);
    });
  });

  // X·ª≠ l√Ω click √¥ trang b·ªã ƒë·ªÉ tr·∫£ item v·ªÅ l∆∞·ªõi
  equipmentSlots.forEach(slot => {
    slot.addEventListener('click', () => {
      const imgEquip = slot.querySelector('img');
      const countEquip = slot.querySelector('.item-count');

      if (imgEquip.style.display === 'none' || imgEquip.src === '') return; // slot tr·ªëng, kh√¥ng l√†m g√¨

      // T√¨m item grid t∆∞∆°ng ·ª©ng ƒë·ªÉ hi·ªán l·∫°i ·∫£nh
      const idx = Array.from(gridItems).findIndex(item => {
        return item.querySelector('img').src === imgEquip.src && item.querySelector('img').style.display === 'none';
      });

      if (idx !== -1) {
        const itemGrid = gridItems[idx];
        const imgGrid = itemGrid.querySelector('img');
        const countGrid = itemGrid.querySelector('.item-count');
        imgGrid.style.display = 'block';
        if (countGrid) countGrid.style.display = 'block';

        // X√≥a kh·ªèi m·∫£ng ƒë√£ trang b·ªã
        equippedIndices = equippedIndices.filter(i => i !== idx);
      }

      // X√≥a ·∫£nh v√† s·ªë l∆∞·ª£ng trong slot trang b·ªã (·∫©n slot)
      imgEquip.src = '';
      imgEquip.style.display = 'none';
      if (countEquip) {
        countEquip.textContent = '';
        countEquip.style.display = 'none';
      }
    });
  });
</script> 
<!-- <script>
let equippedIndices = []; // l∆∞u index item trong l∆∞·ªõi ƒëang ƒë∆∞·ª£c trang b·ªã
let selectedItemIndex = null; // index item hi·ªán ƒëang m·ªü dialog
let selectedFromEquip = false; // true n·∫øu m·ªü t·ª´ √¥ trang b·ªã

// L·∫•y ph·∫ßn t·ª≠ dialog
const dialogWrapper = document.getElementById('itemDialogWrapper');
const dialogName = document.getElementById('dialogItemName');
const dialogIcon = document.getElementById('dialogItemIcon');
const dialogDesc = document.getElementById('dialogItemDesc');
const btnUpgrade = document.getElementById('btnUpgrade');
const btnSelect = document.getElementById('btnSelect');

// L·∫•y item trong l∆∞·ªõi v√† √¥ trang b·ªã
const gridItems = document.querySelectorAll('.grid .item');
const equipmentSlots = document.querySelectorAll('.equipments .item');
console.log(gridItems);
console.log(equipmentSlots);

// H√†m m·ªü dialog
function openItemDialog(name, iconSrc, desc, index, fromEquip) {
  dialogName.textContent = name;
  dialogIcon.src = iconSrc;
  dialogDesc.textContent = desc;
  selectedItemIndex = index;
  selectedFromEquip = fromEquip;

  // X·ª≠ l√Ω hi·ªÉn th·ªã n√∫t
  if (fromEquip) {
    btnSelect.textContent = 'B·ªè ch·ªçn';
    btnSelect.style.display = 'inline-block';
  } else {
    if (equippedIndices.length >= 3) {
      btnSelect.style.display = 'none';
    } else {
      btnSelect.textContent = 'L·ª±a ch·ªçn';
      btnSelect.style.display = 'inline-block';
    }
  }

  dialogWrapper.style.display = 'flex';
}

// ƒê√≥ng dialog khi click ngo√†i
dialogWrapper.addEventListener('click', (e) => {
  if (e.target === dialogWrapper) {
    dialogWrapper.style.display = 'none';
  }
});

// Click n√∫t N√¢ng c·∫•p
btnUpgrade.addEventListener('click', () => {
  alert('N√¢ng c·∫•p item: ' + dialogName.textContent);
});

// Click n√∫t L·ª±a ch·ªçn / B·ªè ch·ªçn
btnSelect.addEventListener('click', () => {
  if (selectedFromEquip) {
    // B·ªè ch·ªçn
    const gridItem = gridItems[selectedItemIndex];
    gridItem.querySelector('img').style.display = 'block';
    const countGrid = gridItem.querySelector('.item-count');
    if (countGrid) {
      countGrid.style.display = 'block';
    }
    equipmentSlots.forEach(slot => {
      if (slot.querySelector('img').src === dialogIcon.src) {
        slot.querySelector('img').src = '';
        slot.querySelector('img').style.display = 'none';
        slot.querySelector('.item-count').style.display = 'none';
      }
    });
    equippedIndices = equippedIndices.filter(i => i !== selectedItemIndex);
  } else {
    // L·ª±a ch·ªçn
    if (equippedIndices.length < 3 && !equippedIndices.includes(selectedItemIndex)) {
      const emptySlot = Array.from(equipmentSlots).find(slot => {
        return slot.querySelector('img').style.display === 'none' || slot.querySelector('img').src === '';
      });
      if (emptySlot) {
        const gridItem = gridItems[selectedItemIndex];
        const imgGrid = gridItem.querySelector('img');
        const countGrid = gridItem.querySelector('.item-count');

        emptySlot.querySelector('img').src = imgGrid.src;
        emptySlot.querySelector('img').style.display = 'block';
        if (countGrid) {
          emptySlot.querySelector('.item-count').textContent = countGrid.textContent;
          emptySlot.querySelector('.item-count').style.display = 'block';
        }

        imgGrid.style.display = 'none';
        countGrid.style.display = 'none';
        equippedIndices.push(selectedItemIndex);
      }
    }
  }
  dialogWrapper.style.display = 'none';
});

// G√°n s·ª± ki·ªán click m·ªü dialog cho item trong l∆∞·ªõi
gridItems.forEach((item, idx) => {
  item.addEventListener('click', () => {
    const img = item.querySelector('img');
    if (img.style.display === 'none') return; // ƒë√£ trang b·ªã, kh√¥ng cho ch·ªçn n·ªØa
    openItemDialog('Item ' + (idx+1), img.src, 'M√¥ t·∫£ c·ªßa item ' + (idx+1), idx, false);
  });
});

// G√°n s·ª± ki·ªán click m·ªü dialog cho item trong trang b·ªã
equipmentSlots.forEach((slot, idx) => {
  slot.addEventListener('click', () => {
    const img = slot.querySelector('img');
    if (img.style.display === 'none' || img.src === '') return;
    const gridIndex = equippedIndices[idx] ?? equippedIndices.find(i => gridItems[i].querySelector('img').src === img.src);
    openItemDialog('Item Equip', img.src, 'M√¥ t·∫£ trang b·ªã', gridIndex, true);
  });
});
</script> -->

</body>
</html>
